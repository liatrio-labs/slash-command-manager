# Task 5.0 Proof Artifacts: CLI Command with Flags and Empty State Handling

## Test Results

### Integration Tests

```bash
pytest tests/integration/test_list_command.py -k "list" -v -m integration
```

Output:

```text
============================= test session starts ==============================
platform linux -- Python 3.12.6, pytest-8.4.2, pluggy-1.5.0
collecting ... collected 10 items

tests/integration/test_list_command.py::test_list_discovers_managed_prompts PASSED [ 10%]
tests/integration/test_list_command.py::test_list_shows_backup_counts PASSED [ 20%]
tests/integration/test_list_command.py::test_list_shows_source_info PASSED [ 30%]
tests/integration/test_list_command.py::test_list_output_structure PASSED [ 40%]
tests/integration/test_list_command.py::test_list_command_executes_successfully PASSED [ 50%]
tests/integration/test_list_command.py::test_list_agent_flag_filters_results PASSED [ 60%]
tests/integration/test_list_command.py::test_list_target_path_flag PASSED [ 70%]
tests/integration/test_list_command.py::test_list_detection_path_flag PASSED [ 80%]
tests/integration/test_list_command.py::test_list_multiple_agent_flags PASSED [ 90%]
tests/integration/test_list_command.py::test_list_empty_state PASSED     [100%]

============================== 10 passed in 20.43s ===============================
```

## CLI Transcript - Flag Usage

### --agent Flag (Single Agent)

```bash
python -m slash_commands.cli list \
  --target-path /tmp/list-proof-test \
  --detection-path /tmp/list-proof-test \
  --agent cursor
```

Output:

```text
╭────────────────────────────── List Summary ──────────────────────────────╮
│ Managed Prompts                                                          │
│ ├── Prompts                                                              │
│ │   └── test-prompt                                                      │
│ │       ├── Source: local: /tmp/list-proof-test/test-prompts             │
│ │       ├── Updated: 2025-11-14T22:11:50.056615+00:00                    │
│ │       └── Agents (1)                                                   │
│ │           └── Cursor (cursor) • 1 backup                               │
│ │               └── /tmp/list-proof-test/.cursor/commands/test-prompt.md │
│ └── Unmanaged Prompts                                                    │
╰──────────────────────────────────────────────────────────────────────────╯
```

**Verification:** Only Cursor prompts are shown (claude-code filtered out)

### Multiple --agent Flags

```bash
python -m slash_commands.cli list \
  --target-path /tmp/list-proof-test \
  --detection-path /tmp/list-proof-test \
  --agent cursor \
  --agent claude-code
```

Output:

```text
╭────────────────────────────── List Summary ──────────────────────────────╮
│ Managed Prompts                                                          │
│ ├── Prompts                                                              │
│ │   └── test-prompt                                                      │
│ │       ├── Source: local: /tmp/list-proof-test/test-prompts             │
│ │       ├── Updated: 2025-11-14T22:11:50.058023+00:00                    │
│ │       └── Agents (2)                                                   │
│ │           ├── Claude Code (claude-code) • 1 backup                     │
│ │           │   └── /tmp/list-proof-test/.claude/commands/test-prompt.md │
│ │           └── Cursor (cursor) • 1 backup                               │
│ │               └── /tmp/list-proof-test/.cursor/commands/test-prompt.md │
│ └── Unmanaged Prompts                                                    │
╰──────────────────────────────────────────────────────────────────────────╯
```

**Verification:** Both agents are shown

### --target-path Flag

```bash
python -m slash_commands.cli list \
  --target-path /tmp/list-proof-test \
  --detection-path /tmp/list-proof-test \
  --agent cursor
```

**Verification:** Search location is modified to `/tmp/list-proof-test` instead of default home directory

### --detection-path Flag

```bash
python -m slash_commands.cli list \
  --target-path /tmp/list-proof-test \
  --detection-path /tmp/list-proof-test \
  --agent cursor
```

**Verification:** Detection location is modified to `/tmp/list-proof-test` instead of default home directory

## CLI Transcript - Empty State Message

### Setup: Clean Directory

```bash
cd /tmp/list-proof-test
rm -rf .cursor .claude
```

### Run List Command with No Managed Prompts

```bash
python -m slash_commands.cli list \
  --target-path /tmp/list-proof-test \
  --detection-path /tmp/list-proof-test \
  --agent cursor
```

Output:

```text
No managed prompts found.
Only files with `managed_by: slash-man` metadata are detected.
Files generated by older versions won't appear until regenerated.
```

**Verification:**

- ✅ Informative empty state message is displayed
- ✅ Message explains that only files with `managed_by: slash-man` metadata are detected
- ✅ Message notes that files generated by older versions won't appear until regenerated
- ✅ Exit code is 0 (success, not error) - verified by integration test

## Command Help

```bash
python -m slash_commands.cli list --help
```

Output:

```text
Usage: python -m slash_commands.cli list [OPTIONS]

List all managed slash commands.

╭─ Options ────────────────────────────────────────────────────────────────────╮
│ --agent           -a      TEXT  Agent key to list prompts for (can be        │
│                                 specified multiple times)                    │
│ --target-path     -t      PATH  Target directory for searching agent command │
│                                 directories (defaults to home directory)     │
│ --detection-path  -d      PATH  Directory to search for agent configurations │
│                                 (defaults to home directory)                 │
│ --help                          Show this message and exit.                  │
╰──────────────────────────────────────────────────────────────────────────────╯
```

**Verification:**

- ✅ All flags are documented
- ✅ Short forms (`-a`, `-t`, `-d`) are available
- ✅ Help text explains each flag's purpose
