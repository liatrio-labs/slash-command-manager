[semantic_release]
# Use annotated tags like v1.2.3
tag_format = "v{version}"
# Allow 0.x.x versions (required for pre-1.0.0 releases)
allow_zero_version = true
# Update the version field in pyproject.toml
# Use version_toml (not version_variables) for TOML files
version_toml = ["pyproject.toml:project.version"]
# Generate changelog and commit version bumps
# Ensure uv.lock stays in sync with version changes and is committed
# pyproject.toml is automatically committed when updated via version_toml
# build_command runs after version is updated in pyproject.toml to refresh uv.lock
build_command = """
uv lock --upgrade-package "$PACKAGE_NAME"
git add uv.lock
"""
assets = ["uv.lock"]

[semantic_release.changelog]
# Generate CHANGELOG.md in Markdown
default_templates = { changelog_file = "CHANGELOG.md", output_format = "md" }

[semantic_release.branches]
# Release from the main branch
main = { match = "main" }
# Allow prereleases from feature branches (for dev-release job testing)
dev = { match = "^(feat|fix|perf)/.+", prerelease = true, prerelease_token = "dev" }

[semantic_release.remote]
# Use GitHub token from environment variable
token = { env = "GH_TOKEN" }
